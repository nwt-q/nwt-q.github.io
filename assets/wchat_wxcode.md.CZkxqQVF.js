import{_ as n,C as d,c as i,o,j as a,G as r,a8 as p,a as s}from"./chunks/framework.DMZhn_gK.js";const q=JSON.parse('{"title":"小程序码生成与计费代理接口","description":"","frontmatter":{},"headers":[],"relativePath":"wchat/wxcode.md","filePath":"wchat/wxcode.md","lastUpdated":1767255108000}'),l={name:"wchat/wxcode.md"};function c(h,t,u,b,g,k){const e=d("ArticleMetadata");return o(),i("div",null,[t[0]||(t[0]=a("h2",{id:"葵花码-小程序码生成接口",tabindex:"-1"},[s("葵花码/小程序码生成接口 "),a("a",{class:"header-anchor",href:"#葵花码-小程序码生成接口","aria-label":'Permalink to "葵花码/小程序码生成接口"'},"​")],-1)),t[1]||(t[1]=a("h1",{id:"小程序码生成与计费代理接口",tabindex:"-1"},[s("小程序码生成与计费代理接口 "),a("a",{class:"header-anchor",href:"#小程序码生成与计费代理接口","aria-label":'Permalink to "小程序码生成与计费代理接口"'},"​")],-1)),r(e),t[2]||(t[2]=p(`<div class="tip custom-block"><p class="custom-block-title">关于接口</p><p>请求地址随机分配一个独立的通道</p></div><div class="language- vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>POST /generate-qr</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>这是一个代理接口，负责对外部小程序码生成 API 进行认证、计费、扣款以及结果缓存。每次成功调用（无论是生成还是命中缓存）都会从用户余额中扣除固定费用。</p><h2 id="认证-authorization" tabindex="-1">认证 (Authorization) <a class="header-anchor" href="#认证-authorization" aria-label="Permalink to &quot;认证 (Authorization)&quot;">​</a></h2><p>接口使用 <strong>Token</strong> 进行认证。您的私有 API Key 必须放在 <code>Authorization</code> 请求头中。</p><table tabindex="0"><thead><tr><th>字段</th><th>类型</th><th>描述</th></tr></thead><tbody><tr><td><code>Authorization</code></td><td>Header String</td><td>格式：<code>[您的 API Token]</code>。</td></tr></tbody></table><p><strong>示例:</strong> <code>Authorization: SECRET_TEST_TOKEN</code></p><h2 id="费用与计费" tabindex="-1">费用与计费 <a class="header-anchor" href="#费用与计费" aria-label="Permalink to &quot;费用与计费&quot;">​</a></h2><ul><li><strong>计费模式:</strong> 每次调用成功（包括缓存命中）都会扣除 <strong>0.1</strong> 单位的费用。</li><li><strong>退款:</strong> 若外部 API 调用失败、网络错误或参数错误，系统会自动回滚扣除的费用。回滚后的余额会在响应中返回。</li></ul><h2 id="请求-request" tabindex="-1">请求 (Request) <a class="header-anchor" href="#请求-request" aria-label="Permalink to &quot;请求 (Request)&quot;">​</a></h2><table tabindex="0"><thead><tr><th>字段</th><th>类型</th><th>是否必需</th><th>描述</th></tr></thead><tbody><tr><td><code>Content-Type</code></td><td>Header String</td><td>是</td><td>必须设置为 <code>application/json</code>。</td></tr><tr><td><code>appid</code></td><td>String</td><td>是</td><td>小程序的 AppID。</td></tr><tr><td><code>pagepath</code></td><td>String</td><td>是</td><td>小程序页面的路径，例如 <code>pages/index/index</code>。</td></tr><tr><td><code>type</code></td><td>String</td><td>是</td><td>指定生成的小程序码类型。这是动态参数，需根据外部 API 要求填写，例如：<code>wxcode</code> (默认类型) 或 <code>wxcode_a</code> 等。</td></tr></tbody></table><p><strong>请求示例 (cURL)</strong></p><div class="language- vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>curl -X POST https://code.jxoj.top/generate-qr\\</span></span>
<span class="line"><span>  -H &quot;Authorization: Bearer SECRET_TEST_TOKEN&quot; \\</span></span>
<span class="line"><span>  -H &quot;Content-Type: application/json&quot; \\</span></span>
<span class="line"><span>  -d &#39;{</span></span>
<span class="line"><span>      &quot;appid&quot;: &quot;wx6b698132322112&quot;,</span></span>
<span class="line"><span>      &quot;pagepath&quot;: &quot;pages/index/index&quot;,</span></span>
<span class="line"><span>      &quot;type&quot;: &quot;wxcode&quot;</span></span>
<span class="line"><span>  }&#39;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><h2 id="响应-response" tabindex="-1">响应 (Response) <a class="header-anchor" href="#响应-response" aria-label="Permalink to &quot;响应 (Response)&quot;">​</a></h2><h3 id="状态码-200-成功" tabindex="-1">状态码 200: 成功 <a class="header-anchor" href="#状态码-200-成功" aria-label="Permalink to &quot;状态码 200: 成功&quot;">​</a></h3><table tabindex="0"><thead><tr><th>字段</th><th>类型</th><th>描述</th></tr></thead><tbody><tr><td><code>code</code></td><td>Number</td><td>200，表示成功。</td></tr><tr><td><code>msg</code></td><td>String</td><td>成功消息。如果命中缓存，可能会显示。</td></tr><tr><td><code>qrcode_url</code></td><td>String</td><td>生成或缓存的小程序码图片 URL。</td></tr><tr><td><code>current_balance</code></td><td>String</td><td><strong>用户的最新余额</strong>（扣费后的精确到小数点后两位的余额）。</td></tr></tbody></table><p><strong>响应示例</strong></p><div class="language-json vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">json</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;code&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">200</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;msg&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;葵花码生成成功&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;qrcode_url&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;http://mx.qrurl.net/api/img/wxacode?sid=251111Ok67Bc&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;current_balance&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;19.30&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>错误响应</p><table tabindex="0"><thead><tr><th>状态码</th><th>字段</th><th>描述</th></tr></thead><tbody><tr><td><strong>401</strong></td><td><code>msg</code></td><td>认证失败：Token 无效或缺失。</td></tr><tr><td><strong>402</strong></td><td><code>msg</code>, <code>current_balance</code></td><td>支付失败：用户余额不足。</td></tr><tr><td><strong>400</strong></td><td><code>msg</code>, <code>current_balance</code></td><td>参数错误：缺少 <code>appid</code>, <code>pagepath</code>, 或 <code>type</code>。费用已回滚。</td></tr><tr><td><strong>502</strong></td><td><code>msg</code>, <code>detail</code>, <code>current_balance</code></td><td>外部 API 返回错误。<code>detail</code> 字段包含外部 API 响应详情。费用已回滚。</td></tr><tr><td><strong>500</strong></td><td><code>msg</code>, <code>current_balance</code></td><td>内部服务或网络连接错误（例如调用外部 API 超时）。费用已回滚。</td></tr></tbody></table>`,20))])}const E=n(l,[["render",c]]);export{q as __pageData,E as default};
